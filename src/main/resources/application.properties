# Spring Boot application properties

# H2 Database Configuration (for development)
# spring.datasource.url=jdbc:h2:mem:pcdDb;DB_CLOSE_DELAY=-1
# spring.datasource.driverClassName=org.h2.Driver
# spring.datasource.username=sa
# spring.datasource.password=
# spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
# spring.h2.console.enabled=true
# spring.h2.console.path=/h2-console

# MySQL Configuration (for production - configure later)
# spring.datasource.url=jdbc:mysql://localhost:3306/pcd_manager_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
# spring.datasource.username=your_mysql_username
# spring.datasource.password=your_mysql_password
# spring.jpa.hibernate.ddl-auto=update
# spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# PostgreSQL Datasource Configuration
spring.datasource.url=jdbc:postgresql://${MY_DB_HOST}:${MY_DB_PORT}/${MY_DB_NAME}
spring.datasource.username=postgres
spring.datasource.password=5Z2eyQfc!
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration for PostgreSQL
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
# Keep as create-drop for dev, consider changing for prod
spring.jpa.show-sql=true
# To disable SQL logs, change the above to false, or comment it out.
spring.jpa.properties.hibernate.format_sql=true

# Comment out or remove H2 specific properties
# spring.h2.console.enabled=true
# spring.h2.console.path=/h2-console
# spring.datasource.url=jdbc:h2:file:./data/pcdmanager;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
# spring.datasource.driverClassName=org.h2.Driver
# spring.datasource.username=sa
# spring.datasource.password=
# spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# Security configuration (we'll refine this)
# Default in-memory user (for testing, will be replaced)
spring.security.user.name=user
spring.security.user.password=password

# Remove file upload size limits
spring.servlet.multipart.max-file-size=-1
spring.servlet.multipart.max-request-size=-1

# Enable live template reloading
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.period=0

# Enable logging for Spring Data JPA and Hibernate
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.transaction=DEBUG

# Improve upload handling
spring.servlet.multipart.enabled=true
spring.servlet.multipart.resolve-lazily=false

# Set active profile to development mode
#

# Configure upload directory (absolute path for better reliability)
app.upload.dir=${user.dir}/uploads

# Hibernate configuration
# spring.jpa.properties.hibernate.format_sql=true # This was duplicated, already set above

# For MySQL in production (currently commented out)
# spring.datasource.url=jdbc:mysql://${MYSQL_HOST:localhost}:3306/pcdmanager
# spring.datasource.username=root
# spring.datasource.password=secret
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Add multipart file upload configuration
# spring.servlet.multipart.enabled=true # This was duplicated
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB
spring.servlet.multipart.file-size-threshold=2MB

# Enable path migration for existing file paths in the database
app.migration.path-fix=true

# Enable orphaned file record cleanup
app.cleanup.orphaned-files=true

# Allow circular dependencies between services
spring.main.allow-circular-references=true