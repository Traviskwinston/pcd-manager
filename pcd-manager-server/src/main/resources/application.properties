# Spring Boot application properties

# H2 Database Configuration (for development)
# spring.datasource.url=jdbc:h2:mem:pcdDb;DB_CLOSE_DELAY=-1
# spring.datasource.driverClassName=org.h2.Driver
# spring.datasource.username=sa
# spring.datasource.password=
# spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
# spring.h2.console.enabled=true
# spring.h2.console.path=/h2-console

# MySQL Configuration (for production - configure later)
# spring.datasource.url=jdbc:mysql://localhost:3306/pcd_manager_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
# spring.datasource.username=your_mysql_username
# spring.datasource.password=your_mysql_password
# spring.jpa.hibernate.ddl-auto=update
# spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# File-based H2 database (will persist between restarts)
spring.datasource.url=jdbc:h2:file:./data/pcdmanager;DB_CLOSE_ON_EXIT=FALSE;AUTO_RECONNECT=TRUE
spring.datasource.username=sa
spring.datasource.password=password
spring.datasource.driver-class-name=org.h2.Driver
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
# Automatically create/update schema based on entities
spring.jpa.hibernate.ddl-auto=create-drop

# Security configuration (we'll refine this)
# Default in-memory user (for testing, will be replaced)
spring.security.user.name=user
spring.security.user.password=password

# Remove file upload size limits
spring.servlet.multipart.max-file-size=-1
spring.servlet.multipart.max-request-size=-1

# Enable live template reloading
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.period=0

# Enable logging for Spring Data JPA and Hibernate
spring.jpa.show-sql=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.transaction=DEBUG

# Improve upload handling
spring.servlet.multipart.enabled=true
spring.servlet.multipart.resolve-lazily=false

# Set active profile to development mode
spring.profiles.active=dev

# Configure upload directory (absolute path for better reliability)
app.upload.dir=${user.dir}/uploads

# Hibernate configuration
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# For MySQL in production (currently commented out)
# spring.datasource.url=jdbc:mysql://${MYSQL_HOST:localhost}:3306/pcdmanager
# spring.datasource.username=root
# spring.datasource.password=secret
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Add multipart file upload configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB
spring.servlet.multipart.file-size-threshold=2MB

# Enable path migration for existing file paths in the database
app.migration.path-fix=true

# Enable orphaned file record cleanup
app.cleanup.orphaned-files=true